---

title: Analysis


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "01_analysis.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_analysis.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">aat_analysis.make_condition_templates</span> <span class="kn">import</span> <span class="n">make_condition_templates</span>
<span class="kn">from</span> <span class="nn">aat_analysis.json_to_df</span> <span class="kn">import</span> <span class="n">json_to_df</span>
<span class="kn">from</span> <span class="nn">aat_analysis.utils</span> <span class="kn">import</span> <span class="n">merge_data</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">external_folder</span> <span class="o">=</span> <span class="s2">&quot;data/external/&quot;</span>
<span class="n">interim_folder</span> <span class="o">=</span> <span class="s2">&quot;data/interim/&quot;</span>
<span class="n">raw_data_folder</span> <span class="o">=</span> <span class="s2">&quot;data/raw/&quot;</span>
<span class="n">processed_data_file</span> <span class="o">=</span> <span class="s2">&quot;data/processed/data.pkl&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">templates</span> <span class="o">=</span> <span class="n">make_condition_templates</span><span class="p">(</span><span class="n">external_folder</span><span class="p">)</span>
<span class="c1"># Preprocesses data for each participant and moves it to interim</span>
<span class="n">json_to_df</span><span class="p">(</span><span class="n">raw_data_folder</span><span class="p">,</span> <span class="n">external_folder</span><span class="p">,</span> <span class="n">interim_folder</span><span class="p">,</span> <span class="n">templates</span><span class="p">)</span>
<span class="c1"># Merges interim data and stores it for further analysis</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">merge_data</span><span class="p">(</span><span class="n">interim_folder</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;interpolated&#39;</span><span class="p">,</span><span class="s1">&#39;interpolated_gyro&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">processed_data_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|█████████████████████████████████████████| 179/179 [01:28&lt;00:00,  2.03it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Removing test participants.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PID_1</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setting-participant-and-session-variables">Setting participant and session variables<a class="anchor-link" href="#Setting-participant-and-session-variables"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_missing_session</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="s1">&#39;.1&#39;</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span> <span class="k">else</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fixing-participant-and-session-ids">Fixing participant and session ids<a class="anchor-link" href="#Fixing-participant-and-session-ids"> </a></h3><p>{% include note.html content='@Alexandrina: Perhaps you can check whether all of these changes are ok.' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clean_ids</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^0-9.]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;PID_fixed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">PID_1</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_ids</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">add_missing_session</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># more options can be specified also</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;PID_1&#39;</span><span class="p">)[[</span><span class="s1">&#39;PID_fixed&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">first</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PID_fixed</th>
    </tr>
    <tr>
      <th>PID_1</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>101</th>
      <td>101.1</td>
    </tr>
    <tr>
      <th>101 vitit2</th>
      <td>101.2</td>
    </tr>
    <tr>
      <th>102</th>
      <td>102.1</td>
    </tr>
    <tr>
      <th>102.2</th>
      <td>102.2</td>
    </tr>
    <tr>
      <th>103</th>
      <td>103.1</td>
    </tr>
    <tr>
      <th>103.2</th>
      <td>103.2</td>
    </tr>
    <tr>
      <th>104</th>
      <td>104.1</td>
    </tr>
    <tr>
      <th>104.1</th>
      <td>104.1</td>
    </tr>
    <tr>
      <th>104.2</th>
      <td>104.2</td>
    </tr>
    <tr>
      <th>105.1</th>
      <td>105.1</td>
    </tr>
    <tr>
      <th>105.2</th>
      <td>105.2</td>
    </tr>
    <tr>
      <th>106.1</th>
      <td>106.1</td>
    </tr>
    <tr>
      <th>106.2</th>
      <td>106.2</td>
    </tr>
    <tr>
      <th>107.1</th>
      <td>107.1</td>
    </tr>
    <tr>
      <th>107.2</th>
      <td>107.2</td>
    </tr>
    <tr>
      <th>108.1</th>
      <td>108.1</td>
    </tr>
    <tr>
      <th>108.2</th>
      <td>108.2</td>
    </tr>
    <tr>
      <th>109</th>
      <td>109.1</td>
    </tr>
    <tr>
      <th>109_2</th>
      <td>109.2</td>
    </tr>
    <tr>
      <th>110.1</th>
      <td>110.1</td>
    </tr>
    <tr>
      <th>110.2</th>
      <td>110.2</td>
    </tr>
    <tr>
      <th>111.1</th>
      <td>111.1</td>
    </tr>
    <tr>
      <th>111.2</th>
      <td>111.2</td>
    </tr>
    <tr>
      <th>1114_1</th>
      <td>1114.1</td>
    </tr>
    <tr>
      <th>1114_2</th>
      <td>1114.2</td>
    </tr>
    <tr>
      <th>1116.1</th>
      <td>1116.1</td>
    </tr>
    <tr>
      <th>1116.2</th>
      <td>1116.2</td>
    </tr>
    <tr>
      <th>112.1</th>
      <td>112.1</td>
    </tr>
    <tr>
      <th>112.2</th>
      <td>112.2</td>
    </tr>
    <tr>
      <th>1124</th>
      <td>1124.1</td>
    </tr>
    <tr>
      <th>1124.2</th>
      <td>1124.2</td>
    </tr>
    <tr>
      <th>1127_1</th>
      <td>1127.1</td>
    </tr>
    <tr>
      <th>1127_2</th>
      <td>1127.2</td>
    </tr>
    <tr>
      <th>113.1</th>
      <td>113.1</td>
    </tr>
    <tr>
      <th>113.2</th>
      <td>113.2</td>
    </tr>
    <tr>
      <th>115.1</th>
      <td>115.1</td>
    </tr>
    <tr>
      <th>115.2</th>
      <td>115.2</td>
    </tr>
    <tr>
      <th>116.1</th>
      <td>116.1</td>
    </tr>
    <tr>
      <th>117_1</th>
      <td>117.1</td>
    </tr>
    <tr>
      <th>118.1</th>
      <td>118.1</td>
    </tr>
    <tr>
      <th>118.2</th>
      <td>118.2</td>
    </tr>
    <tr>
      <th>119.1</th>
      <td>119.1</td>
    </tr>
    <tr>
      <th>119.2</th>
      <td>119.2</td>
    </tr>
    <tr>
      <th>120.1</th>
      <td>120.1</td>
    </tr>
    <tr>
      <th>120.2</th>
      <td>120.2</td>
    </tr>
    <tr>
      <th>1201.1</th>
      <td>1201.1</td>
    </tr>
    <tr>
      <th>1201.2</th>
      <td>1201.2</td>
    </tr>
    <tr>
      <th>121.1</th>
      <td>121.1</td>
    </tr>
    <tr>
      <th>121.2</th>
      <td>121.2</td>
    </tr>
    <tr>
      <th>122.1</th>
      <td>122.1</td>
    </tr>
    <tr>
      <th>122.2</th>
      <td>122.2</td>
    </tr>
    <tr>
      <th>1228.1</th>
      <td>1228.1</td>
    </tr>
    <tr>
      <th>1228.2</th>
      <td>1228.2</td>
    </tr>
    <tr>
      <th>123</th>
      <td>123.1</td>
    </tr>
    <tr>
      <th>125 session2</th>
      <td>125.2</td>
    </tr>
    <tr>
      <th>126</th>
      <td>126.1</td>
    </tr>
    <tr>
      <th>126 sessie 2</th>
      <td>126.2</td>
    </tr>
    <tr>
      <th>128.1</th>
      <td>128.1</td>
    </tr>
    <tr>
      <th>128.2</th>
      <td>128.2</td>
    </tr>
    <tr>
      <th>129.1</th>
      <td>129.1</td>
    </tr>
    <tr>
      <th>129.2</th>
      <td>129.2</td>
    </tr>
    <tr>
      <th>130.1</th>
      <td>130.1</td>
    </tr>
    <tr>
      <th>130.2</th>
      <td>130.2</td>
    </tr>
    <tr>
      <th>131_1</th>
      <td>131.1</td>
    </tr>
    <tr>
      <th>131_2</th>
      <td>131.2</td>
    </tr>
    <tr>
      <th>132_1</th>
      <td>132.1</td>
    </tr>
    <tr>
      <th>132_2</th>
      <td>132.2</td>
    </tr>
    <tr>
      <th>202.1</th>
      <td>202.1</td>
    </tr>
    <tr>
      <th>202.2</th>
      <td>202.2</td>
    </tr>
    <tr>
      <th>203.1</th>
      <td>203.1</td>
    </tr>
    <tr>
      <th>203.2</th>
      <td>203.2</td>
    </tr>
    <tr>
      <th>204.1</th>
      <td>204.1</td>
    </tr>
    <tr>
      <th>204.2</th>
      <td>204.2</td>
    </tr>
    <tr>
      <th>205.1</th>
      <td>205.1</td>
    </tr>
    <tr>
      <th>205.2</th>
      <td>205.2</td>
    </tr>
    <tr>
      <th>206.1</th>
      <td>206.1</td>
    </tr>
    <tr>
      <th>206.2</th>
      <td>206.2</td>
    </tr>
    <tr>
      <th>207.1</th>
      <td>207.1</td>
    </tr>
    <tr>
      <th>207.2</th>
      <td>207.2</td>
    </tr>
    <tr>
      <th>208_1</th>
      <td>208.1</td>
    </tr>
    <tr>
      <th>208_2</th>
      <td>208.2</td>
    </tr>
    <tr>
      <th>209.1</th>
      <td>209.1</td>
    </tr>
    <tr>
      <th>209.2</th>
      <td>209.2</td>
    </tr>
    <tr>
      <th>210.1</th>
      <td>210.1</td>
    </tr>
    <tr>
      <th>210.2</th>
      <td>210.2</td>
    </tr>
    <tr>
      <th>211_1</th>
      <td>211.1</td>
    </tr>
    <tr>
      <th>211_2</th>
      <td>211.2</td>
    </tr>
    <tr>
      <th>212.1</th>
      <td>212.1</td>
    </tr>
    <tr>
      <th>212.2</th>
      <td>212.2</td>
    </tr>
    <tr>
      <th>213_1</th>
      <td>213.1</td>
    </tr>
    <tr>
      <th>213_2</th>
      <td>213.2</td>
    </tr>
    <tr>
      <th>214.1</th>
      <td>214.1</td>
    </tr>
    <tr>
      <th>214.2</th>
      <td>214.2</td>
    </tr>
    <tr>
      <th>215.1</th>
      <td>215.1</td>
    </tr>
    <tr>
      <th>215.2</th>
      <td>215.2</td>
    </tr>
    <tr>
      <th>216.1</th>
      <td>216.1</td>
    </tr>
    <tr>
      <th>216.2</th>
      <td>216.2</td>
    </tr>
    <tr>
      <th>217</th>
      <td>217.1</td>
    </tr>
    <tr>
      <th>217.2</th>
      <td>217.2</td>
    </tr>
    <tr>
      <th>218.1</th>
      <td>218.1</td>
    </tr>
    <tr>
      <th>218.2</th>
      <td>218.2</td>
    </tr>
    <tr>
      <th>219.2</th>
      <td>219.2</td>
    </tr>
    <tr>
      <th>220</th>
      <td>220.1</td>
    </tr>
    <tr>
      <th>220 session 2</th>
      <td>220.2</td>
    </tr>
    <tr>
      <th>221.1</th>
      <td>221.1</td>
    </tr>
    <tr>
      <th>221.2</th>
      <td>221.2</td>
    </tr>
    <tr>
      <th>222.1</th>
      <td>222.1</td>
    </tr>
    <tr>
      <th>222.2</th>
      <td>222.2</td>
    </tr>
    <tr>
      <th>223.1</th>
      <td>223.1</td>
    </tr>
    <tr>
      <th>223.2</th>
      <td>223.2</td>
    </tr>
    <tr>
      <th>224.1</th>
      <td>224.1</td>
    </tr>
    <tr>
      <th>224.2</th>
      <td>224.2</td>
    </tr>
    <tr>
      <th>225_1</th>
      <td>225.1</td>
    </tr>
    <tr>
      <th>225_2</th>
      <td>225.2</td>
    </tr>
    <tr>
      <th>226,1</th>
      <td>2261.1</td>
    </tr>
    <tr>
      <th>226.2</th>
      <td>226.2</td>
    </tr>
    <tr>
      <th>227_1</th>
      <td>227.1</td>
    </tr>
    <tr>
      <th>227_2</th>
      <td>227.2</td>
    </tr>
    <tr>
      <th>229_1</th>
      <td>229.1</td>
    </tr>
    <tr>
      <th>229_2</th>
      <td>229.2</td>
    </tr>
    <tr>
      <th>230_1</th>
      <td>230.1</td>
    </tr>
    <tr>
      <th>230_2</th>
      <td>230.2</td>
    </tr>
    <tr>
      <th>231.1</th>
      <td>231.1</td>
    </tr>
    <tr>
      <th>231.2</th>
      <td>231.2</td>
    </tr>
    <tr>
      <th>232_1</th>
      <td>232.1</td>
    </tr>
    <tr>
      <th>232_2</th>
      <td>232.2</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Double-sessions">Double sessions<a class="anchor-link" href="#Double-sessions"> </a></h3><p>Participant 104 has three sessions (on 24 Sep, 30 Sep, and 01 Oct). Accuracy rates for all sessions are ok, so for new we remove the second session).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;PID_1&#39;</span><span class="p">)[</span><span class="s1">&#39;PID_fixed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>104.1    2
101.1    1
208.2    1
215.1    1
214.2    1
        ..
117.1    1
116.1    1
115.2    1
115.1    1
232.2    1
Name: PID_fixed, Length: 125, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">PID_1</span> <span class="o">!=</span> <span class="s1">&#39;104.1&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;PID_1&#39;</span><span class="p">)[</span><span class="s1">&#39;PID_fixed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>101.1    1
208.2    1
215.1    1
214.2    1
214.1    1
        ..
117.1    1
116.1    1
115.2    1
115.1    1
232.2    1
Name: PID_fixed, Length: 125, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Setting-participant-and-session-variables">Setting participant and session variables<a class="anchor-link" href="#Setting-participant-and-session-variables"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;participant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">PID_fixed</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;session&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">PID_fixed</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;Session </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">int</span>(x.split(&#39;.&#39;)[1]))
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Adding-condition-and-exclusion-information">Adding condition and exclusion information<a class="anchor-link" href="#Adding-condition-and-exclusion-information"> </a></h2><p>Here we add information about participants' conditions, demographics, and reasons for exclusion from the experimenter logs.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conditions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/external/randomizatielijst.csv&#39;</span><span class="p">)</span>
<span class="n">conditions</span><span class="p">[</span><span class="s1">&#39;participant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">conditions</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">validate</span> <span class="o">=</span> <span class="s1">&#39;many_to_one&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s2">&quot;Participants: </span><span class="si">%s</span><span class="s2"> are in the log files but not in the AAT dataset&#39;&quot;</span><span class="o">%</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">conditions</span><span class="o">.</span><span class="n">participant</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">participant</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#34;Participants: 114, 201, 228, 124, 127 are in the log files but not in the AAT dataset&#39;&#34;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Accuracy">Accuracy<a class="anchor-link" href="#Accuracy"> </a></h2><p>It looks like 70% is a good accuracy cutoff (so we will remove sessions with accuracy rates under 70%).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span><span class="s1">&#39;session&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">accuracy</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAroAAAILCAYAAAAHaz/JAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAiaklEQVR4nO3deZSW9X3//xcoqGxi3aIYj4gONFWoC+KCcUMxLrhGMARZ1Fi3nirGpXE5LlEbjdY1VltFqliPrXtdqhFi2kgFW5eoaFV0XDGICAQiy9y/P/gxX4fNkZnbYT48HufkJHPf133P++L+nCvPuebiok2lUqkEAAAK07alBwAAgGoQugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRVil0R48endGjRzf3LAAA0GzWXpUXTZ06tbnnAACAZuXSBQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAirR2Sw8AANBc9t5775Ye4Vs3YcKElh5hteWMLgAARRK6AAAUyaULAECRZvcd9a18n86Tbm/R78mKOaMLAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAsBq4t57781RRx2Ve++9t6VHgWW0xvUpdAFgNTFmzJh89tlnGTNmTEuPAstojetT6ALAamLevHkN/htWJ61xfQpdAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKtHZLD/BNLFiwIPfcc0+S5Nhjj027du1aeCKgJa3smFDi8aLEfVra8vaxsfs9d+7cnH/++UmSyy67LB06dPh2hv6KNeEzgtakVYXugw8+mNtvvz1J0qFDhxx99NEtPBHQklZ2TCjxeFHiPi1tefvY2P2+/PLL8z//8z9JkiuuuCKXXnrptzP0V6wJnxG0Jq3m0oWZM2fmzjvvrP96zJgxmTlzZssNBLSolR0TSjxelLhPS1vePtbW1jZqv2tra/Of//mf9V//9re/TW1tbVXnXdqa8BlBa9NqQnfMmDGZM2dO/ddz5szJmDFjWm4goEWt7JhQ4vGixH1a2vL28aKLLmrUfl900UWNeqya1oTPCFqbVhG677zzTh5++OFlHn/44YczderUFpgIaEkrOyb89re/Le54sSYcA1e0j8vbv6X3+9lnn13udlOnTm1wlrea1oTPCFqj1T50K5VKbr755tTV1S3zXF1dXW6++eZUKpUWmAxoCV93TLjqqquKOl6sCcfAle3j8nx1v+vq6nL11VevcNtf/OIXjX7fVbUmfEbQWq32ofvcc89l8uTJK3x+0qRJmThx4rc4EdCSvu6YMGvWrBU+1xqPF2vCMfDr9nF5luz3mDFjVvqZz5o1q8F1s9WwJnxG0Fqt1nddWLBgQX71q1997XY333xzdt55Z7dxgcI19piwMq3peLEmHAOb8pneeOONmTZt2tdud/fdd2fw4MFVud1YNT+jvffeuwmTsSaxVlZstT+jCwAAq2K1Dt127drl5JNP/trtTjnllFZ5JgP4Zhp7TFiZ1nS8WBOOgU35TE877bT86Ec/+trthg4dWrV/PGJN+IygNVutL11Ikt122y0777zzCq9/6tu3b3bddddveSqgpXzdMaFLly4rvGazNR4v1oRj4Nft4/Is2e9+/frlwQcfXOFn3qVLlwwfPry5Rl2uan1GEyZMaOJka6Y18df439ZaaY1/tqv1Gd0kadOmTU499dS0bbvsqG3bts0pp5ySNm3atMBkQEv4umPC2WefXdTxYk04Bq5sH5fnq/u95DNfkRWth+a0JnxG0Fqt9qGbJN27d8+gQYOWeXzQoEHp3r17C0wEtKSVHRP69+9f3PFiTTgGrmgfl7d/S+93//79l7td9+7d079//+YddAXWhM8IWqNWEbpJMmLEiHTq1Kn+606dOmXEiBEtNxDQolZ2TCjxeFHiPi1teft48cUXN2q/L7744kY9Vk1rwmcErU2rCd2uXbs2uM5qxIgR6dq1a8sNBLSolR0TSjxelLhPS1vePm655ZaN2u8tt9yywdnbPffcM1tuuWVV513amvAZQWuz2v9ltK86/PDDM2/evPr/DazZVnZMKPF4UeI+LW15+9jY/f7bv/3bnH/++UmSn/3sZ1Wdc0XWhM8IWpM2lVX4dwmPPPLIJMn999/f7AMBwJrqq3+r3V0XVs1X/wxn9x31rXzPzpNub9Hv2RJ3XWgt67PVXLoAAADfhNAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAgCIJXQAAiiR0AQAoktAFAKBIQhcAVhPrrbdeg/+G1UlrXJ9CFwBWEyNGjMiGG26YESNGtPQosIzWuD7XbukBAIDFBg8enMGDB7f0GLBcrXF9OqMLAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFEnoAgBQJKELAECRhC4AAEUSugAAFGntlh4AAKAaOk+6fY34nqyYM7oAABRJ6AIAUCSXLgAAxZgwYUJLj8BqxBldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIgldAACKJHQBACiS0AUAoEhCFwCAIrWpVCqVb/qiXXbZJV9++WV69OhRjZkAAKBe9+7d88tf/vIbv27tVflmHTt2XJWXAQDAt2aVzugCAMDqzjW6AAAUSegCAFAkoQsAQJGELgAARRK6AAAUSegCAFAkoQsAQJGELgAARRK6AAAUSegCAFAkoQsAQJGELgAARRK61Fu4cGHGjBmTgw46KL17985+++2Xm266KQsWLGjU63//+9/nlFNOSb9+/bLddttlwIABufrqqzN37twqT05zauo6+Kq6urocc8wx6dmzZxUmpZqaug6+/PLL3HjjjRk4cGC23377DBgwIJdffnlmzZpV5clpbk1dC1OmTMnJJ5+cvn37Zvvtt8+hhx6ae++9t8pTUy3Tpk3LTjvtlDFjxjT6NTNnzswll1ySfffdN3369MmRRx6Zxx57rHpDfoXQpd4ll1ySK664Il27ds1xxx2XTTfdNNdff31Gjx79ta+dOHFihgwZkmeffTb9+/fPsGHD0rVr19x222057rjj8uWXX34Le0BzaMo6WNqYMWPy0ksvVWFKqq0p62DBggU54YQTcsMNN2STTTbJsGHDstlmm+XOO+/MCSeckPnz538Le0BzacpamDJlSo499tj85je/yfe///0ce+yxmTt3bi688MJcddVV38L0NKc//vGPOf300zNnzpxGv2bu3LkZNWpUxo0blz59+mTo0KGZNWtWzjjjjNx1111VnPb/V4FKpfLCCy9UampqKqeffnqlrq6uUqlUKnV1dZWzzz67UlNTU3nmmWdW+voDDzyw8r3vfa/y0ksv1T9WV1dXOf/88ys1NTWV22+/varz0zyaug6+6r333qv07t27UlNTU6mpqanWyFRBU9fBP/7jP1Zqamoqf/d3f9fg8YsvvrhSU1NTeeCBB6o1Os2sqWvhpJNOqtTU1FSeeuqp+sfmzJlTOeCAAyq9evWq1NbWVnV+ms8HH3xQOeKII+qP6XfccUejXverX/2qUlNTU7nrrrvqH5s9e3bl4IMPrvTp06cyffr0Kk28mDO6JEnuvvvuJMlpp52WNm3aJEnatGmTM888M23atMl99923wte+9dZbeeedd7Lffvuld+/e9Y+3adMmp556apLk2WefreL0NJemrIOvqlQq+dnPfpZNNtkkW221VbXGpUqaug7uvvvudOvWLWeccUaDx0eNGpUjjjgi66yzTnUGp9k1dS288sorWX/99TNgwID6xzp27JhDDjkkdXV1eeWVV6o3PM1mzJgxOfTQQzNlypTsuuuu3+i148aNy0YbbZQhQ4bUP9apU6f81V/9VebNm5dHHnmkucdtQOiSJJk8eXI22GCD1NTUNHh80003zVZbbZVJkyat8LWdOnXKWWedlaOOOmqZ59q3b58krtNtJZqyDr7qnnvuyfPPP59LLrkk6667bjVGpYqasg7eeuutfPjhh9l3333Trl27Bs9tscUWufLKK/ODH/ygKnPT/Jp6TOjatWvmzJmTL774osHj06ZNS5JssMEGzTswVTF27Nh069Ytd911Vw477LBGv662trb+mt611lqrwXP9+vVLkkb//8qqErpk/vz5+eSTT7Llllsu9/lu3bpl1qxZmTFjxnKf/853vpMTTzwxe+211zLPPfXUU0mSbbbZpvkGpiqaug6W+Pjjj3P11Vfn6KOPzm677VaNUamipq6DN998M0my7bbb5je/+U2GDBmSPn36pH///rnyyiv90NuKNMcxYciQIVm0aFFGjx6d9957L3PmzMm//uu/5oEHHshf/MVfZJdddqnW+DSjiy++OA8++GB23HHHb/S62traJFnuGtp4442zzjrr5N13322OEVdo7aq+O63CzJkzkySdO3de7vNLHp89e3b+7M/+rNHvO3369Fx//fVJksGDBzdtSKquudbBhRdemA4dOuScc85p9hmpvqaug08//TRJMn78+IwfPz577bVXhgwZkueffz533HFHXn755dx5553LnO1l9dMcx4Rhw4ZlrbXWyuWXX54DDjig/vE99tgj11xzzTJn+Vg97bnnnqv0uiVrqEuXLst9vlOnTpk9e/aqjtUoQpcsXLgwyf+7zGBpSx7/JndOmD17dn7yk59k+vTpGTZsWINrd1k9Ncc6ePDBB/Pss8/m+uuvX+GBjdVbU9fBvHnzkiwO3UsvvTTHHHNMkmTRokU588wz88QTT2TcuHEZPnx4c49OM2uOY8KLL76YW2+9Ne3atcvBBx+czp0753e/+11+97vf5brrrsuFF15Yf+0v5WnMGlpyzKgWoUv9NZQruifiklsBrbfeeo16vxkzZuSEE07Iq6++mn322Sfnnntu8wxKVTV1HUyfPj1XXHFF9t9//wwcOLA6Q1J1TV0HbdsuviLue9/7Xn3kJslaa62Vs88+O0888UQef/xxodsKNHUtzJkzJyeddFLq6upy//33p3v37vWvO+usszJu3Lhss802GTp0aBWmZ3Ww5C+eruiWgvPnz0+HDh2qOoNrdEmnTp3Stm3bFd4Xb8mvFVb066uvqq2tzeDBg/Pqq69m3333zfXXX5+11/bzVGvQ1HVwySWXZNGiRbnwwgurNiPV19R10KlTpySLQ3dp3bp1S5cuXfL+++8307RUU1PXwq9//evMnDkzw4YNq4/cZPFZvIsuuihJ8sADDzTz1KxO1l9//SRZ4RqaM2dO/TGjWhQIad++fTbffPN88MEHy33+gw8+yAYbbJCuXbuu9H1ef/31HH/88fnss89yxBFH5LLLLhO5rUhT18GTTz6ZZMXXcvXs2TPdunXLM8880yzzUh1NXQdLbie3orOACxcudFlLK9HUtfDJJ58kSXr06LHMcxtuuGE22GCDfPzxx802L6ufJceD5a2hTz/9NF9++WWDH4KqQYWQJNlpp53y0EMPZerUqQ0W3bRp0/Lee+9l7733Xunr33vvvYwaNSozZszIyJEjc84557juqhVqyjo47bTTlvv4v/zLv2T69Ok57bTTGvVbAVpeU9ZB79690759+0yaNCmLFi1q8JeN3n777cydO9fdOFqRpqyFDTfcMEkyderUZZ774osvMnPmTP88eOE233zzbL755nnhhRdSV1dXf2lTkjz//PNJkh122KGqM7h0gSTJ4YcfniS59tprU1dXl2TxTf+vueaaVCqVld41oa6uLmeeeWZmzJiR4447Lueee67IbaWasg5OP/305f5no402qn9+xIgR1d4FmkFT1kHnzp3zgx/8IB999FFuvfXW+scXLFhQ/0++Lu+e26yemrIW9tlnn6y33nq56667GlyusmjRolx55ZWpVCo5+OCDqzo/LW/QoEH55JNPGvxzv3PmzMktt9ySdddd9xvdl3dVOKNLkmT33XfPQQcdlMceeyyDBw9Ov3798r//+7+ZPHlyBg4c2OCn9htuuCHJ4nBJkqeffjq///3v0759+3To0KH++a/aaKONcuyxx34r+8Kqa8o6oBxNXQfnnHNOXnzxxfz93/99nn/++fTq1SvPPfdcXn/99Rx00EHZb7/9vu1dYhU1ZS1suOGGueCCC3L++efnsMMOy8CBA9OlS5dMnDgxU6ZMyS677OKH38Is73hw4okn5oknnsjPf/7zTJo0Kd/97nfzH//xH3n//fdzwQUXfKPblq6KNpVKpVLV70CrsWDBgtx666154IEHMm3atGy++eYZNGhQTjzxxAa3Blnyq6Y33ngjSfLzn/88Y8eOXel79+rVKw899FD1hqfZrOo6WJHDDjssU6ZM+drtWL00dR18/vnnuemmm/LUU09lxowZ6datW44++uiMHDnSvVNbmaauhYkTJ+a2227LSy+9lD/96U/57ne/m0MPPTQnnHDCCm87xerr/vvvz3nnnZfzzjtvmR9UVrQGpk+fnmuuuSbjx4/PvHnzsvXWW+f444//Vs7oC10AAIrkGl0AAIokdAEAKJLQBQCgSEIXAIAiCV0AAIokdAEAKJLQBQCgSEIXAIAiCV0AAIokdAEAKJLQBQCgSEIXAIAiCV0AAIokdAEAKJLQBQCgSEIXKNabb76Zn/70p9lrr72y3XbbZccdd8yQIUPy5JNPNthu3rx5uf7663PggQemT58+2XfffXPxxRdnxowZ33i7c889Nz179szrr7++zDw9e/bMYYcdVv/1DTfckJ49e+a5557LD3/4w2y33XYZOHBg/vjHPyZJXnjhhZx22mnp379/tttuu/Tt2zcjR47MxIkTl3nvGTNm5PLLL8++++6b3r17Z+DAgbn22mvr3+umm25Kz549c9999y3z2g8//DC9evXKWWed9Q3+dAFWf0IXKNLLL7+cH/7wh5kwYUL69++fkSNHpn///nnllVfy13/91xk/fnySxfF67LHH5qabbkqnTp0yZMiQ9OzZM+PGjcvw4cMzZ86cb7TdqjjrrLOy7rrrZtiwYenXr186duyYp59+OsOGDcuLL76YAQMGZPjw4dlhhx3y3HPP5fjjj28Q0n/4wx9y9NFH584778wWW2yRoUOH5jvf+U5uueWWnHrqqVm4cGEOO+ywtGnTJo888sgy3/+RRx5JpVJpEOEAJVi7pQcAqIbrrrsuCxcuzP33358ePXrUP/7YY4/ljDPOyKOPPpp99tknt956a15//fUMHz485513Xtq0aZMk+Yd/+Idcc801ue+++zJy5MhGb7cqNttss9x5551p2/b/nXu4+uqr07lz5zz44IPZaKON6h+/7bbbcvXVV+fxxx/Pn//5nydJrrrqqnz44Yc577zzMmLEiPptL7zwwtx777155plncsABB2TnnXfOpEmTMm3atGy66ab12z3yyCPZeOONs/vuu6/S/ACrK6ELFGnEiBE56qijGkRukvTr1y9J8tlnnyVJ/v3f/z2dOnXK6NGj6+M1SX784x9n1qxZ2Wabbb7Rdqti//33bxC5dXV1GT16dNq3b98gcpc3//z58/PUU09lq622ahC5SXLSSSdlgw02yMYbb5wkOfzwwzNp0qQ8/vjj9du+9tpreeuttzJy5MistdZaq7wPAKsjoQsUac8990yy+Nf6U6ZMSW1tbaZOnZoXXnghSbJo0aL86U9/ynvvvZe+fftmnXXWafD6jh075qc//WmSNHq7VdWtW7cGX7dt2zb7779/ksXXz/7f//1famtr89Zbb+W///u/kyyO4SSpra3N3Llz85d/+ZfLfd8zzjij/usDDzwwl156aR555JH60F1yKYPLFoASCV2gSB9//HEuvfTSPPPMM6lUKmnbtm222mqr7LTTTnnttdeSJF988UWSpFOnTit9r8Zut6rWXXfdZR574403ctlll+X5559PkrRr1y49evTIdtttl3fffTeVSuUbz9apU6cMGDAgjz76aN59991sueWWefTRR1NTU1N/GQRASYQuUJxKpZKf/OQneeutt3LSSSdlwIAB2XbbbbPuuutm+vTp9Xce6NChQ5LU35lgaXPnzk2HDh0avV2S+ssaloToEvPmzWv0/HPmzMmoUaMye/bsnHPOOdl9992z9dZbp3379nnppZfy6KOP1m/bsWPHRs+WLL584dFHH80TTzyRnXbaKZ9++mmGDx/e6NkAWhN3XQCK88Ybb+TNN9/M/vvvnzPOOCPbb799/VnTt99+O8niEO3cuXM222yzvP7665k/f36D95g/f3722GOPjBo1qtHbJYvPvCaLA/OramtrGz3/xIkTM3369AwdOjSjRo1Kr1690r59+2XmT5Lu3bunXbt2efnll5d5n2nTpmWHHXbIBRdcUP/Y7rvvnk022STjx4/P+PHj07Zt2xx66KGNng2gNRG6QHGWROGSv7C1xMyZM/OLX/wiSbJw4cIkyaBBgzJ79uzcdNNNDbYdO3Zs5s6dm9122+0bbbf11lsnSf3ty5LF19PecsstjZ5/yXXAS8//0Ucf5cYbb2ww/zrrrJOBAwfm7bffXuYeuUu+55LZkmSttdbKIYcckpdffjmPPfZYdt111wZ3YAAoiUsXgOJstdVW6d27dyZPnpwf/ehH2XHHHfP555/n6aefzvz587Peeuvl888/T7L4zgQTJkzILbfckkmTJqVPnz555513MmHChGy//fb1v9Zv7HaHHHJIrrvuuvzTP/1T3n///WyxxRb5r//6r8yaNSubb755o+bfaaed0q1btzz00EP5/PPP06tXr3z88cf59a9/nXXWWSdt2rTJzJkz67c/++yz88ILL+T888/Pk08+mW233TavvPJKJk2alAEDBuSggw5q8P5HHHFEbr/99nz88cf5m7/5m6b/gQOsppzRBYrTtm3b3HzzzTnyyCPzwQcf5J//+Z8zefLkfP/738+//du/ZY899si7776b2tradOzYMePGjcvxxx+fTz75JGPHjs2rr76aH//4x7njjjvqzw43druNNtooY8eOzW677ZZnn3029913X3r06JF77rknXbp0adT8HTp0yB133JEDDjggr776au6666689tprGTRoUB5++OH06tUrkydPrr8ud9NNN819992XwYMH54033sjYsWPz0Ucf5eSTT8611167zPvX1NSkR48eWW+99erv7gBQojaVpf/GBABFmz17dvbYY48MHDgwV111VUuPA1A1zugCrGFuu+22fPnllznmmGNaehSAqnKNLsAaYujQoZk2bVref//97Lrrrunbt29LjwRQVc7oAqwh1l9//fzhD3/IHnvskV/+8pctPQ5A1blGFwCAIjmjCwBAkYQuAABFEroAABRJ6AIAUCShCwBAkYQuAABFEroAABRJ6AIAUCShCwBAkYQuAABFEroAABRJ6AIAUCShCwBAkf4/WoJNOQshxRwAAAAASUVORK5CYII=
"
width=349
height=261
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Filtering">Filtering<a class="anchor-link" href="#Filtering"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Excluding-participants-for-various-reasons">Excluding participants for various reasons<a class="anchor-link" href="#Excluding-participants-for-various-reasons"> </a></h3><p>Two participants have to be excluded based on the experimenter protocol.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nan</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;exclusies == exclusies&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()[[</span><span class="s1">&#39;exclusies&#39;</span><span class="p">,</span><span class="s1">&#39;reden van exclusie&#39;</span><span class="p">]])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">participant</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;116&#39;</span><span class="p">,</span><span class="s1">&#39;123&#39;</span><span class="p">])</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>exclusies</th>
      <th>reden van exclusie</th>
    </tr>
    <tr>
      <th>participant</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>116</th>
      <td>exclude</td>
      <td>ziek geworden en niet naar de 2de sessie gekomen</td>
    </tr>
    <tr>
      <th>123</th>
      <td>exclude</td>
      <td>geen geur kon ruiken</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;exclusies == exclusies&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()[[</span><span class="s1">&#39;exclusies&#39;</span><span class="p">,</span><span class="s1">&#39;reden van exclusie&#39;</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>exclusies</th>
      <th>reden van exclusie</th>
    </tr>
    <tr>
      <th>participant</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="These-functions-should-be-moved-to-the-aat_analysis-package">These functions should be moved to the aat_analysis package<a class="anchor-link" href="#These-functions-should-be-moved-to-the-aat_analysis-package"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">analyze_exclusions</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;completion&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;completion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># We first specify detailled sources of error</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;completed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">completion</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;NA&#39;</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;no_response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;ND&#39;</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;timeout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wrong_response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="n">df</span><span class="o">.</span><span class="n">response</span><span class="o">==</span><span class="s1">&#39;pull&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">correct_response</span><span class="o">==</span><span class="s1">&#39;push&#39;</span><span class="p">))</span> <span class="o">|</span>
                                <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">response</span><span class="o">==</span><span class="s1">&#39;push&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">correct_response</span><span class="o">==</span><span class="s1">&#39;pull&#39;</span><span class="p">)))</span>
    <span class="c1"># Short RT trials are not also categorized as wrong responses.</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">short_rt</span><span class="p">,</span><span class="s1">&#39;wrong_response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> 
    <span class="c1"># We calculate additional reversed validities for reversed responses</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">reversed_validity</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">reversed_validity</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># Creating recoded responses for analysis of exclusion reasons</span>
    <span class="n">push_loc</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">response</span><span class="o">==</span><span class="s1">&#39;push&#39;</span><span class="p">)</span>
    <span class="n">pull_loc</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">response</span><span class="o">==</span><span class="s1">&#39;pull&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;response_recoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">response</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">push_loc</span><span class="p">,</span><span class="s1">&#39;response_recoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pull&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pull_loc</span><span class="p">,</span><span class="s1">&#39;response_recoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;push&#39;</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;error_recoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">response_recoded</span> <span class="o">!=</span> <span class="n">df</span><span class="o">.</span><span class="n">correct_response</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_valid_recoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">short_rt</span> <span class="o">|</span> <span class="n">df</span><span class="o">.</span><span class="n">error_recoded</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;wrong_response_recoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="n">df</span><span class="o">.</span><span class="n">response_recoded</span><span class="o">==</span><span class="s1">&#39;pull&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">correct_response</span><span class="o">==</span><span class="s1">&#39;push&#39;</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">response_recoded</span><span class="o">==</span><span class="s1">&#39;push&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">correct_response</span><span class="o">==</span><span class="s1">&#39;pull&#39;</span><span class="p">)))</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">short_rt</span><span class="p">,</span><span class="s1">&#39;wrong_response_recoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">filter_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">short_rt_cutoff</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">session_accuracy_cutoff</span> <span class="o">=</span> <span class="mf">.8</span><span class="p">):</span>
    <span class="c1"># Only include participants who actually started the study</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;NA&#39;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">is_practice</span><span class="p">,</span><span class="s1">&#39;missing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">missing</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Exclude short RTs</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;short_rt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rt</span> <span class="o">&lt;</span> <span class="n">short_rt_cutoff</span>
    <span class="c1"># Errors error trials</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">response</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">correct_response</span>
    <span class="c1"># Only include valid trials</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">short_rt</span> <span class="o">|</span> <span class="n">data</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">is_practice</span><span class="p">,</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="c1"># Only experimental trials are considered</span>
    <span class="c1"># Exclude sessions with low validity</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;excluded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span><span class="s1">&#39;session&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">is_valid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">session_accuracy_cutoff</span>
    <span class="c1"># Exclude participants without valid AAT sessions</span>
    <span class="c1">#data[&#39;prop_sessions_excluded&#39;]  = data.groupby(&#39;participant&#39;).session_excluded.transform(np.mean)</span>
    <span class="c1">#data[&#39;no_aat_session&#39;] = data.prop_sessions_excluded == 1</span>
    <span class="c1">#data[&#39;excluded&#39;] = data.no_aat_session</span>
    <span class="c1"># Only analyzed valid data of included participants</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;analysis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">is_practice</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">excluded</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">is_valid</span><span class="p">))</span>
    <span class="c1"># Getting detailled reasons for exclusions (for later presentation)</span>
    <span class="n">analyze_exclusions</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="k">def</span> <span class="nf">exclusion_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">extra_variables</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">only_excluded</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">show_table</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">basic_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span> <span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="s1">&#39;wrong_response&#39;</span><span class="p">,</span><span class="s1">&#39;short_rt&#39;</span><span class="p">,</span> <span class="s1">&#39;no_response&#39;</span><span class="p">,</span> <span class="s1">&#39;is_valid&#39;</span><span class="p">,</span><span class="s1">&#39;is_valid_recoded&#39;</span><span class="p">,</span><span class="s1">&#39;completed&#39;</span><span class="p">]</span>
    <span class="n">agg_functions</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">basic_keys</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extra_variables</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">extra_variables</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">extra_variables</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>
    <span class="n">agg_functions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">extra_variables</span><span class="p">)</span>
    <span class="n">analyze</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">excluded</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">is_practice</span><span class="o">==</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">todisplay</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">excluded</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">is_practice</span><span class="o">==</span><span class="kc">False</span><span class="p">))</span> <span class="k">if</span> <span class="n">only_excluded</span> <span class="k">else</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">is_practice</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">reasons</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">todisplay</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span><span class="s1">&#39;session&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">agg_functions</span><span class="p">)</span>
    <span class="n">reasons</span><span class="p">[</span><span class="s1">&#39;completed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reasons</span><span class="o">.</span><span class="n">completed</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="c1">#reasons = reasons.sort_values(by=[&#39;participant&#39;,&#39;session&#39;,&#39;is_valid&#39;,&#39;missing&#39;,&#39;wrong_response&#39;],ascending=False)</span>
    <span class="c1">#print(&quot;hey&quot;)</span>
    <span class="n">overview_dict</span> <span class="o">=</span> <span class="n">exclusion_reasons_overview_dict</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">analyze</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span><span class="s1">&#39;session&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">agg_functions</span><span class="p">))</span>
    <span class="n">colored_table</span> <span class="o">=</span> <span class="n">color_exclusion_reasons</span><span class="p">(</span><span class="n">reasons</span><span class="p">,</span> <span class="n">extra_variables</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_table</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">colored_table</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;Of </span><span class="si">%(total)s</span><span class="s2"> sessions, </span><span class="si">%(excluded_total)s</span><span class="s2"> should be excluded due to too little valid data.&quot;</span><span class="o">%</span><span class="k">overview_dict</span>))
    <span class="k">return</span> <span class="n">overview_dict</span>

<span class="k">def</span> <span class="nf">color_exclusion_reasons</span><span class="p">(</span><span class="n">reasons</span><span class="p">,</span> <span class="n">extra_variables</span> <span class="o">=</span> <span class="p">[]):</span>
    <span class="k">def</span> <span class="nf">highlight_max</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">is_max</span> <span class="o">=</span> <span class="n">s</span> <span class="o">==</span> <span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;color: red&#39;</span> <span class="k">if</span> <span class="n">v</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">is_max</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">highlight_completed</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span> <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;color: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">color</span>

    <span class="k">def</span> <span class="nf">highlight_recoded</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mf">.8</span> <span class="k">else</span> <span class="s1">&#39;orange&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;color: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">color</span> 

    <span class="n">s</span> <span class="o">=</span> <span class="n">reasons</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">highlight_max</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;missing&#39;</span><span class="p">,</span><span class="s1">&#39;wrong_response&#39;</span><span class="p">,</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="s1">&#39;short_rt&#39;</span><span class="p">,</span> <span class="s1">&#39;no_response&#39;</span><span class="p">])</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">highlight_completed</span><span class="p">,</span> <span class="n">subset</span> <span class="o">=</span> <span class="s1">&#39;completed&#39;</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">highlight_recoded</span><span class="p">,</span> <span class="n">subset</span> <span class="o">=</span> <span class="s1">&#39;is_valid_recoded&#39;</span><span class="p">)</span>
    <span class="n">formats</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">reasons</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:.0%}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">formats</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;completed&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">extra_variables</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">formats</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">formats</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="k">def</span> <span class="nf">exclusion_reasons_overview_dict</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">reasons</span><span class="p">,</span> <span class="n">cutoff</span> <span class="o">=</span> <span class="mf">.8</span><span class="p">):</span>
    <span class="n">reasons</span><span class="p">[</span><span class="s1">&#39;completed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reasons</span><span class="o">.</span><span class="n">completed</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">reasons_overview</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">participant</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
    <span class="s1">&#39;excluded_total&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;excluded&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span><span class="s1">&#39;session&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()),</span>
    <span class="s1">&#39;no_data&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reasons</span><span class="p">[</span><span class="n">reasons</span><span class="o">.</span><span class="n">missing</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cutoff</span><span class="p">)]),</span>
    <span class="s1">&#39;wrong_responses&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reasons</span><span class="p">[</span><span class="n">reasons</span><span class="o">.</span><span class="n">wrong_response</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cutoff</span><span class="p">)]),</span>
    <span class="s1">&#39;not_completed&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reasons</span><span class="p">[</span><span class="n">reasons</span><span class="o">.</span><span class="n">completed</span><span class="o">==</span><span class="kc">False</span><span class="p">]),</span>
    <span class="s1">&#39;no_data_but_completed&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reasons</span><span class="p">[(</span><span class="n">reasons</span><span class="o">.</span><span class="n">missing</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cutoff</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">reasons</span><span class="o">.</span><span class="n">completed</span><span class="o">==</span><span class="kc">True</span><span class="p">)]),</span>
    <span class="s1">&#39;reversed&#39;</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reasons</span><span class="p">[</span><span class="n">reasons</span><span class="o">.</span><span class="n">is_valid_recoded</span><span class="o">&gt;</span><span class="n">cutoff</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="n">reasons_overview</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reasons_overview</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">reasons_overview</span><span class="p">[</span><span class="s1">&#39;excluded_total&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">reasons_overview</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">filter_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">session_accuracy_cutoff</span> <span class="o">=</span> <span class="mf">.7</span><span class="p">)</span>
<span class="n">reasons</span> <span class="o">=</span> <span class="n">exclusion_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">show_table</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extra_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PID_1&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><style type="text/css">
#T_282a5_row0_col2, #T_282a5_row0_col7, #T_282a5_row1_col0, #T_282a5_row1_col7, #T_282a5_row2_col4, #T_282a5_row2_col7, #T_282a5_row3_col4, #T_282a5_row3_col7, #T_282a5_row4_col0, #T_282a5_row4_col7, #T_282a5_row5_col2, #T_282a5_row5_col7, #T_282a5_row6_col2, #T_282a5_row6_col7, #T_282a5_row7_col0, #T_282a5_row7_col7, #T_282a5_row8_col2, #T_282a5_row8_col7 {
  color: red;
}
#T_282a5_row0_col6, #T_282a5_row1_col6, #T_282a5_row2_col6, #T_282a5_row3_col6, #T_282a5_row4_col6, #T_282a5_row5_col6, #T_282a5_row6_col6, #T_282a5_row7_col6, #T_282a5_row8_col6 {
  color: black;
}
</style>
<table id="T_282a5">
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_282a5_level0_col0" class="col_heading level0 col0" >missing</th>
      <th id="T_282a5_level0_col1" class="col_heading level0 col1" >timeout</th>
      <th id="T_282a5_level0_col2" class="col_heading level0 col2" >wrong_response</th>
      <th id="T_282a5_level0_col3" class="col_heading level0 col3" >short_rt</th>
      <th id="T_282a5_level0_col4" class="col_heading level0 col4" >no_response</th>
      <th id="T_282a5_level0_col5" class="col_heading level0 col5" >is_valid</th>
      <th id="T_282a5_level0_col6" class="col_heading level0 col6" >is_valid_recoded</th>
      <th id="T_282a5_level0_col7" class="col_heading level0 col7" >completed</th>
      <th id="T_282a5_level0_col8" class="col_heading level0 col8" >PID_1</th>
    </tr>
    <tr>
      <th class="index_name level0" >participant</th>
      <th class="index_name level1" >session</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
      <th class="blank col5" >&nbsp;</th>
      <th class="blank col6" >&nbsp;</th>
      <th class="blank col7" >&nbsp;</th>
      <th class="blank col8" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_282a5_level0_row0" class="row_heading level0 row0" >101</th>
      <th id="T_282a5_level1_row0" class="row_heading level1 row0" >Session 2</th>
      <td id="T_282a5_row0_col0" class="data row0 col0" >0%</td>
      <td id="T_282a5_row0_col1" class="data row0 col1" >1%</td>
      <td id="T_282a5_row0_col2" class="data row0 col2" >19%</td>
      <td id="T_282a5_row0_col3" class="data row0 col3" >2%</td>
      <td id="T_282a5_row0_col4" class="data row0 col4" >11%</td>
      <td id="T_282a5_row0_col5" class="data row0 col5" >67%</td>
      <td id="T_282a5_row0_col6" class="data row0 col6" >19%</td>
      <td id="T_282a5_row0_col7" class="data row0 col7" >0</td>
      <td id="T_282a5_row0_col8" class="data row0 col8" >101 vitit2</td>
    </tr>
    <tr>
      <th id="T_282a5_level0_row1" class="row_heading level0 row1" >104</th>
      <th id="T_282a5_level1_row1" class="row_heading level1 row1" >Session 1</th>
      <td id="T_282a5_row1_col0" class="data row1 col0" >100%</td>
      <td id="T_282a5_row1_col1" class="data row1 col1" >0%</td>
      <td id="T_282a5_row1_col2" class="data row1 col2" >0%</td>
      <td id="T_282a5_row1_col3" class="data row1 col3" >0%</td>
      <td id="T_282a5_row1_col4" class="data row1 col4" >0%</td>
      <td id="T_282a5_row1_col5" class="data row1 col5" >0%</td>
      <td id="T_282a5_row1_col6" class="data row1 col6" >0%</td>
      <td id="T_282a5_row1_col7" class="data row1 col7" >0</td>
      <td id="T_282a5_row1_col8" class="data row1 col8" >104</td>
    </tr>
    <tr>
      <th id="T_282a5_level0_row2" class="row_heading level0 row2" rowspan="2">106</th>
      <th id="T_282a5_level1_row2" class="row_heading level1 row2" >Session 1</th>
      <td id="T_282a5_row2_col0" class="data row2 col0" >0%</td>
      <td id="T_282a5_row2_col1" class="data row2 col1" >1%</td>
      <td id="T_282a5_row2_col2" class="data row2 col2" >2%</td>
      <td id="T_282a5_row2_col3" class="data row2 col3" >0%</td>
      <td id="T_282a5_row2_col4" class="data row2 col4" >31%</td>
      <td id="T_282a5_row2_col5" class="data row2 col5" >67%</td>
      <td id="T_282a5_row2_col6" class="data row2 col6" >2%</td>
      <td id="T_282a5_row2_col7" class="data row2 col7" >0</td>
      <td id="T_282a5_row2_col8" class="data row2 col8" >106.1</td>
    </tr>
    <tr>
      <th id="T_282a5_level1_row3" class="row_heading level1 row3" >Session 2</th>
      <td id="T_282a5_row3_col0" class="data row3 col0" >0%</td>
      <td id="T_282a5_row3_col1" class="data row3 col1" >0%</td>
      <td id="T_282a5_row3_col2" class="data row3 col2" >1%</td>
      <td id="T_282a5_row3_col3" class="data row3 col3" >0%</td>
      <td id="T_282a5_row3_col4" class="data row3 col4" >36%</td>
      <td id="T_282a5_row3_col5" class="data row3 col5" >63%</td>
      <td id="T_282a5_row3_col6" class="data row3 col6" >1%</td>
      <td id="T_282a5_row3_col7" class="data row3 col7" >0</td>
      <td id="T_282a5_row3_col8" class="data row3 col8" >106.2</td>
    </tr>
    <tr>
      <th id="T_282a5_level0_row4" class="row_heading level0 row4" >118</th>
      <th id="T_282a5_level1_row4" class="row_heading level1 row4" >Session 1</th>
      <td id="T_282a5_row4_col0" class="data row4 col0" >50%</td>
      <td id="T_282a5_row4_col1" class="data row4 col1" >0%</td>
      <td id="T_282a5_row4_col2" class="data row4 col2" >3%</td>
      <td id="T_282a5_row4_col3" class="data row4 col3" >1%</td>
      <td id="T_282a5_row4_col4" class="data row4 col4" >2%</td>
      <td id="T_282a5_row4_col5" class="data row4 col5" >44%</td>
      <td id="T_282a5_row4_col6" class="data row4 col6" >3%</td>
      <td id="T_282a5_row4_col7" class="data row4 col7" >0</td>
      <td id="T_282a5_row4_col8" class="data row4 col8" >118.1</td>
    </tr>
    <tr>
      <th id="T_282a5_level0_row5" class="row_heading level0 row5" >1228</th>
      <th id="T_282a5_level1_row5" class="row_heading level1 row5" >Session 1</th>
      <td id="T_282a5_row5_col0" class="data row5 col0" >0%</td>
      <td id="T_282a5_row5_col1" class="data row5 col1" >1%</td>
      <td id="T_282a5_row5_col2" class="data row5 col2" >27%</td>
      <td id="T_282a5_row5_col3" class="data row5 col3" >4%</td>
      <td id="T_282a5_row5_col4" class="data row5 col4" >3%</td>
      <td id="T_282a5_row5_col5" class="data row5 col5" >65%</td>
      <td id="T_282a5_row5_col6" class="data row5 col6" >27%</td>
      <td id="T_282a5_row5_col7" class="data row5 col7" >0</td>
      <td id="T_282a5_row5_col8" class="data row5 col8" >1228.1</td>
    </tr>
    <tr>
      <th id="T_282a5_level0_row6" class="row_heading level0 row6" >130</th>
      <th id="T_282a5_level1_row6" class="row_heading level1 row6" >Session 2</th>
      <td id="T_282a5_row6_col0" class="data row6 col0" >0%</td>
      <td id="T_282a5_row6_col1" class="data row6 col1" >0%</td>
      <td id="T_282a5_row6_col2" class="data row6 col2" >45%</td>
      <td id="T_282a5_row6_col3" class="data row6 col3" >0%</td>
      <td id="T_282a5_row6_col4" class="data row6 col4" >0%</td>
      <td id="T_282a5_row6_col5" class="data row6 col5" >55%</td>
      <td id="T_282a5_row6_col6" class="data row6 col6" >45%</td>
      <td id="T_282a5_row6_col7" class="data row6 col7" >0</td>
      <td id="T_282a5_row6_col8" class="data row6 col8" >130.2</td>
    </tr>
    <tr>
      <th id="T_282a5_level0_row7" class="row_heading level0 row7" >210</th>
      <th id="T_282a5_level1_row7" class="row_heading level1 row7" >Session 1</th>
      <td id="T_282a5_row7_col0" class="data row7 col0" >50%</td>
      <td id="T_282a5_row7_col1" class="data row7 col1" >0%</td>
      <td id="T_282a5_row7_col2" class="data row7 col2" >2%</td>
      <td id="T_282a5_row7_col3" class="data row7 col3" >0%</td>
      <td id="T_282a5_row7_col4" class="data row7 col4" >0%</td>
      <td id="T_282a5_row7_col5" class="data row7 col5" >47%</td>
      <td id="T_282a5_row7_col6" class="data row7 col6" >2%</td>
      <td id="T_282a5_row7_col7" class="data row7 col7" >0</td>
      <td id="T_282a5_row7_col8" class="data row7 col8" >210.1</td>
    </tr>
    <tr>
      <th id="T_282a5_level0_row8" class="row_heading level0 row8" >220</th>
      <th id="T_282a5_level1_row8" class="row_heading level1 row8" >Session 1</th>
      <td id="T_282a5_row8_col0" class="data row8 col0" >0%</td>
      <td id="T_282a5_row8_col1" class="data row8 col1" >0%</td>
      <td id="T_282a5_row8_col2" class="data row8 col2" >27%</td>
      <td id="T_282a5_row8_col3" class="data row8 col3" >3%</td>
      <td id="T_282a5_row8_col4" class="data row8 col4" >1%</td>
      <td id="T_282a5_row8_col5" class="data row8 col5" >69%</td>
      <td id="T_282a5_row8_col6" class="data row8 col6" >27%</td>
      <td id="T_282a5_row8_col7" class="data row8 col7" >0</td>
      <td id="T_282a5_row8_col8" class="data row8 col8" >220</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">Of 64 sessions, 9 should be excluded due to too little valid data.</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Participants">Participants<a class="anchor-link" href="#Participants"> </a></h2><p>{% include warning.html content='Some participants did not complete two sessions (or data from one of the sessions is not available).' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> participants are included in the data analysis. Together, these participants completed </span><span class="si">%d</span><span class="s2"> AAT sessions.&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">analysis</span><span class="p">]</span><span class="o">.</span><span class="n">participant</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span><span class="s1">&#39;session&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()))))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">63 participants are included in the data analysis. Together, these participants completed 123 AAT sessions.</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conditions">Conditions<a class="anchor-link" href="#Conditions"> </a></h3><p>The conditions are pretty well balanced.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_experimental&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">group</span> <span class="o">==</span> <span class="s1">&#39;experimenteel&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_patient&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;patient&#39;</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;Participants per cell:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">is_experimental</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span>  <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">is_patient</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;Percentage participants per cell:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">is_experimental</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span>  <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;participant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">is_patient</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">Participants per cell:
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>is_experimental</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>is_patient</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>17</td>
      <td>16</td>
    </tr>
    <tr>
      <th>True</th>
      <td>15</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">Percentage participants per cell:
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>is_experimental</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>is_patient</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>0.265625</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>True</th>
      <td>0.234375</td>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Hypothesis-tests">Hypothesis tests<a class="anchor-link" href="#Hypothesis-tests"> </a></h2><p>Session 1: conditioned group received intranasal insulin; control group received placebo
Session 2: both groups received placebo.</p>
<p>We hypothesize, that intranasal insulin and conditioning with intranasal insulin would decrease hunger. So we expect that conditioned group would have less hunger (so I guess smaller approach tendency towards food) on both session 1 and 2 in comparison to the control group. I also attach a file with the group randomization so you can see what number belongs to what group. Also I indicated in the file which participants had to be excluded from the analysis (a few of them got dizzy during testing and had to eat something so their results are not reliable).</p>
<p>rt ~ response <em> stimulus_type </em> session <em> condition + (response </em> stimulus_type | participant)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_food&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">stimulus_set</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_pull&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;pull&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;is_session_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">session</span> <span class="o">==</span> <span class="s1">&#39;Session 2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">analysis</span><span class="p">]</span><span class="o">.</span><span class="n">is_food</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">analysis</span><span class="p">]</span><span class="o">.</span><span class="n">is_pull</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>is_pull</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>is_food</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2088</td>
      <td>1957</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4308</td>
      <td>3973</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">analysis</span><span class="p">][[</span><span class="s1">&#39;participant&#39;</span><span class="p">,</span><span class="s1">&#39;is_session_2&#39;</span><span class="p">,</span><span class="s1">&#39;is_experimental&#39;</span><span class="p">,</span><span class="s1">&#39;is_pull&#39;</span><span class="p">,</span><span class="s1">&#39;is_food&#39;</span><span class="p">,</span><span class="s1">&#39;rt_inv&#39;</span><span class="p">,</span><span class="s1">&#39;force&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/processed/analysis_data.csv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">i</span> <span class="n">r_data</span>
<span class="nf">library</span><span class="p">(</span><span class="n">lmerTest</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="nf">lmer</span><span class="p">(</span><span class="n">rt_inv</span> <span class="o">~</span> <span class="n">is_pull</span> <span class="o">*</span> <span class="n">is_food</span> <span class="o">*</span> <span class="n">is_session_2</span> <span class="o">*</span> <span class="n">is_experimental</span> <span class="o">+</span> <span class="p">(</span><span class="n">is_pull</span> <span class="o">*</span> <span class="n">is_food</span> <span class="o">|</span> <span class="n">participant</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">r_data</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: rt_inv ~ is_pull * is_food * is_session_2 * is_experimental +  
    (is_pull * is_food | participant)
   Data: r_data

REML criterion at convergence: 13045.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.9957 -0.5708 -0.0452  0.4875  8.8313 

Random effects:
 Groups      Name            Variance Std.Dev. Corr             
 participant (Intercept)     0.03664  0.1914                    
             is_pull         0.03743  0.1935   -0.11            
             is_food         0.01200  0.1096   -0.02  0.56      
             is_pull:is_food 0.04608  0.2147    0.13 -0.54 -0.64
 Residual                    0.16070  0.4009                    
Number of obs: 12326, groups:  participant, 63

Fixed effects:
                                               Estimate Std. Error         df
(Intercept)                                   1.606e+00  3.980e-02  8.343e+01
is_pull                                       9.481e-02  4.520e-02  9.749e+01
is_food                                       3.315e-02  3.105e-02  1.192e+02
is_session_2                                  5.937e-02  2.741e-02  6.986e+03
is_experimental                               5.882e-03  5.502e-02  7.909e+01
is_pull:is_food                               1.263e-01  5.218e-02  1.034e+02
is_pull:is_session_2                         -3.822e-03  3.935e-02  7.743e+03
is_food:is_session_2                         -3.087e-02  3.286e-02  5.718e+03
is_pull:is_experimental                      -2.565e-04  6.195e-02  9.059e+01
is_food:is_experimental                       9.357e-03  4.223e-02  1.104e+02
is_session_2:is_experimental                  4.294e-02  3.653e-02  9.189e+03
is_pull:is_food:is_session_2                  8.201e-02  4.786e-02  7.524e+03
is_pull:is_food:is_experimental              -4.385e-02  7.137e-02  9.571e+01
is_pull:is_session_2:is_experimental         -2.099e-02  5.259e-02  9.788e+03
is_food:is_session_2:is_experimental         -2.503e-02  4.413e-02  8.160e+03
is_pull:is_food:is_session_2:is_experimental -3.006e-02  6.406e-02  9.636e+03
                                             t value Pr(&gt;|t|)    
(Intercept)                                   40.357   &lt;2e-16 ***
is_pull                                        2.097   0.0385 *  
is_food                                        1.068   0.2878    
is_session_2                                   2.166   0.0303 *  
is_experimental                                0.107   0.9151    
is_pull:is_food                                2.420   0.0173 *  
is_pull:is_session_2                          -0.097   0.9226    
is_food:is_session_2                          -0.939   0.3476    
is_pull:is_experimental                       -0.004   0.9967    
is_food:is_experimental                        0.222   0.8251    
is_session_2:is_experimental                   1.175   0.2399    
is_pull:is_food:is_session_2                   1.713   0.0867 .  
is_pull:is_food:is_experimental               -0.614   0.5404    
is_pull:is_session_2:is_experimental          -0.399   0.6899    
is_food:is_session_2:is_experimental          -0.567   0.5706    
is_pull:is_food:is_session_2:is_experimental  -0.469   0.6389    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>R[write to console]: 
Correlation matrix not shown by default, as p = 16 &gt; 12.
Use print(object, correlation=TRUE)  or
    vcov(object)        if you need it


</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">i</span> <span class="n">r_data</span>
<span class="nf">library</span><span class="p">(</span><span class="n">lmerTest</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="nf">lmer</span><span class="p">(</span><span class="n">force</span> <span class="o">~</span> <span class="n">is_pull</span> <span class="o">*</span> <span class="n">is_food</span> <span class="o">*</span> <span class="n">is_session_2</span> <span class="o">*</span> <span class="n">is_experimental</span> <span class="o">+</span> <span class="p">(</span><span class="n">is_pull</span> <span class="o">*</span> <span class="n">is_food</span> <span class="o">|</span> <span class="n">participant</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">r_data</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: force ~ is_pull * is_food * is_session_2 * is_experimental +  
    (is_pull * is_food | participant)
   Data: r_data

REML criterion at convergence: 78036.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.1293 -0.4954 -0.0474  0.4160 12.3080 

Random effects:
 Groups      Name            Variance Std.Dev. Corr             
 participant (Intercept)     39.88    6.315                     
             is_pull         16.22    4.028    -0.09            
             is_food         11.97    3.460    -0.02  0.50      
             is_pull:is_food 33.43    5.782     0.05 -0.66 -0.94
 Residual                    31.04    5.571                     
Number of obs: 12326, groups:  participant, 63

Fixed effects:
                                               Estimate Std. Error         df
(Intercept)                                   1.402e+01  1.169e+00  6.550e+01
is_pull                                      -4.706e-01  8.313e-01  8.160e+01
is_food                                      -2.476e-01  7.093e-01  7.993e+01
is_session_2                                 -2.226e+00  3.866e-01  9.223e+03
is_experimental                              -9.626e-01  1.634e+00  6.458e+01
is_pull:is_food                               7.988e-02  1.153e+00  7.539e+01
is_pull:is_session_2                          3.007e+00  5.569e-01  1.052e+04
is_food:is_session_2                          2.804e-01  4.677e-01  9.006e+03
is_pull:is_experimental                       2.331e+00  1.149e+00  7.739e+01
is_food:is_experimental                       5.566e-02  9.821e-01  7.618e+01
is_session_2:is_experimental                  1.723e+00  5.130e-01  1.071e+04
is_pull:is_food:is_session_2                 -1.210e+00  6.804e-01  1.096e+04
is_pull:is_food:is_experimental               5.737e-01  1.599e+00  7.226e+01
is_pull:is_session_2:is_experimental         -1.877e+00  7.400e-01  1.146e+04
is_food:is_session_2:is_experimental          1.017e+00  6.233e-01  1.060e+04
is_pull:is_food:is_session_2:is_experimental -9.315e-01  9.040e-01  1.167e+04
                                             t value Pr(&gt;|t|)    
(Intercept)                                   11.990  &lt; 2e-16 ***
is_pull                                       -0.566 0.572886    
is_food                                       -0.349 0.727986    
is_session_2                                  -5.757 8.81e-09 ***
is_experimental                               -0.589 0.557918    
is_pull:is_food                                0.069 0.944928    
is_pull:is_session_2                           5.400 6.81e-08 ***
is_food:is_session_2                           0.599 0.548876    
is_pull:is_experimental                        2.028 0.045964 *  
is_food:is_experimental                        0.057 0.954954    
is_session_2:is_experimental                   3.358 0.000787 ***
is_pull:is_food:is_session_2                  -1.779 0.075246 .  
is_pull:is_food:is_experimental                0.359 0.720732    
is_pull:is_session_2:is_experimental          -2.537 0.011189 *  
is_food:is_session_2:is_experimental           1.631 0.102898    
is_pull:is_food:is_session_2:is_experimental  -1.030 0.302800    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>R[write to console]: 
Correlation matrix not shown by default, as p = 16 &gt; 12.
Use print(object, correlation=TRUE)  or
    vcov(object)        if you need it


</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

